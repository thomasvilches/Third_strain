# COVID-19 Agent Based Model
Quantifying the potential dominance of immune-evading SARS-CoV-2 variants in the United States

Pratha Sah *et al*

## Model details:
A stochastic, age-stratified agent-based computational model for the transmission dynamics of COVID-19. The computational model simulates autonomous agents (representing individuals in a human population) and their interactions within a constrained virtual environment. Agents follow the natural history of disease, including epidemiological stages of susceptible, infected and incubating, asymptomatic, presymptomatic, and symptomatic with either mild, severe, or critical illness, recovered, and dead.

Model features include:

- Age structured with realistic contact dynamics
- Asymptomatic, Presymptomatic transmission
- Isolation of mild/severe cases
- Isolation of symptomatic individuals
- The average number of daily contacts can be changed to fit to data

## How to download an run

Download the entire repository as a **ZIP** or **clone** the repository.

In [Julia REPL](https://julialang.org/project/) include the file *simulations_cluster.jl* using the command

```
include("simulations_cluster.jl")
```

Since the model is stochastic, many realizations are required to get an accurate picture of the results. We recommend running this in an embarrassingly parallel manner. This essentially means running the main function repeatedly, saving the results for each replicate. This can be done very easily using Julia's Distributed library. Simply 'addprocs' or using 'ClusterManagers' to connect to a cluster to launch **n** number of parallel workers.

Then use the command

```
run_param_scen(b,h,init,fm,fs,trans,vaccination,vaccine,r,index,day,status,days_after)
```

to run the scenarios. The arguments are

- b: Float64 \- probability of transmission for presymptomatic cases.
- h: Int64 \- previous herd immunity in the population (either 5, 10, 20, 30 or 50%).
- init: Int64 \- number of initial infected for third strain.
- fm and fs: Float64 \- probability of isolation for symptomatic cases (mild and severe).
- trans: Float64 \- third strain transmissibility.
- vaccination: Bool \- apply vaccination?.
- vaccine: string \- either \"pfizer\" or \"moderna\".
- r: Float64 \- vaccine effectiveness reduction for third strain.
- index: Int64 \- index to differ different files (see *Model output*).
- day: Int64 \- after this time of simulation, every individual is allowed to go back to normal contacts.
- status: Integer \- On April 3, vaccinated individuals are allowed to go back to the normal number of contacts. This argument controls if they need to have first or second dosis (set it to '1' or '2'). If you do not want to allow them to go back to normal, set it to '3'.
- days_after: Int64 \- how many days after the desire dosis the individuals are allowed to go back to normal behavior.

All the scenarios presented in the paper can be run adding the file 'scen.jl'

```
include("scen.jl")
```

***WARNING:*** this file runs several scenarios (572) which may take a lot of time if one does not have a cluster.

## Model output

***First, make sure that the address inside function 'create_folder' in file [simulations_cluster](simulations_cluster.jl) points to a valid directory in your system.*** 

The model is parameterized to fit to data from US from Octuber to May. The [incidence data](cases_us.csv) was taken from [NY times](https://github.com/nytimes/covid-19-data/). The function 'run_param_scen' will generate a folder, inside the pointed directory, named **results\__b_\_herd\_immu\__h_\__vaccine_\__trans_\__r_\__index_** in which all the ***variables*** are the ones cited in the previous section. ***b*** is the probability, but the '.' is replaced by '\_'.

Inside this folder, one will find different data files. The most important ones are the ones named
**simlevel_\*\_inc\_\*\*.dat** in which

- \* stands for **lat**, **lat2**, **lat3**, **hos**, **hos2**, **hos3**, **icu**, **icu2**, **icu3**, **ded** , **ded2**, **ded3**. Which are the number of infections, Non-ICU hospitalizations, ICU hospitalizations and deaths generated by each one of the strains.

- \*\* stands for **all**, **ag1**, **ag2**, **ag3**, **ag4**, **ag5**, **ag6**. Which are the data for the entire population or each one of the six age groups in the model.

The files contain a *modeltime* x *number of simulations* (by default 501x501) matrix. The first row is the heading of the file and the first column of it is the timeline. The other columns are the incidence of a given outcome in the given day of simulation.